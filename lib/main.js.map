{"version":3,"file":"main.js","sources":["../src/mirror.js","../src/input.js","../src/editable.js","../src/utils.js","../src/main.js"],"sourcesContent":["const attributes = [\n  'borderBottomWidth',\n  'borderLeftWidth',\n  'borderRightWidth',\n  'borderTopStyle',\n  'borderRightStyle',\n  'borderBottomStyle',\n  'borderLeftStyle',\n  'borderTopWidth',\n  'boxSizing',\n  'fontFamily',\n  'fontSize',\n  'fontWeight',\n  'height',\n  'letterSpacing',\n  'lineHeight',\n  'marginBottom',\n  'marginLeft',\n  'marginRight',\n  'marginTop',\n  'outlineWidth',\n  'overflow',\n  'overflowX',\n  'overflowY',\n  'paddingBottom',\n  'paddingLeft',\n  'paddingRight',\n  'paddingTop',\n  'textAlign',\n  'textOverflow',\n  'textTransform',\n  'whiteSpace',\n  'wordBreak',\n  'wordWrap',\n];\n\n/**\n * Create a mirror\n *\n * @param {Element} element The element\n * @param {string} html The html\n *\n * @return {Object} The mirror object\n */\nconst createMirror = (element, html) => {\n\n  /**\n   * The mirror element\n   */\n  const mirror = document.createElement('div');\n\n  /**\n   * Create the CSS for the mirror object\n   *\n   * @returns {Object} The style object\n   */\n  const mirrorCss = () => {\n    const css = {\n      position: 'absolute',\n      left: -9999,\n      top: 0,\n      zIndex: -2000\n    };\n\n    if (element.tagName === 'TEXTAREA') {\n      attributes.push('width');\n    }\n\n    attributes.forEach((attr) => {\n      css[attr] = getComputedStyle(element)[attr];\n    });\n\n    return css;\n  };\n\n  /**\n   * Initialize the mirror\n   *\n   * @param {string} html The html\n   */\n  const initialize = (html) => {\n    const styles = mirrorCss();\n    Object.keys(styles).forEach(key => {\n      mirror.style[key] = styles[key];\n    });\n    mirror.innerHTML = html;\n    element.parentNode.insertBefore(mirror, element.nextSibling);\n  };\n\n  /**\n   * Get the rect\n   *\n   * @returns {Rect} The bounding rect\n   */\n  const rect = () => {\n    const marker = mirror.ownerDocument.getElementById('caret-position-marker');\n    const boundingRect = {\n      left: marker.offsetLeft,\n      top: marker.offsetTop,\n      height: marker.offsetHeight\n    };\n    mirror.parentNode.removeChild(mirror);\n\n    return boundingRect;\n  };\n\n  initialize(html);\n\n  return {\n    rect,\n  };\n};\n\nexport default createMirror;\n","import createMirror from './mirror';\n\n/**\n * Create a Input caret object.\\\n *\n * @param {Element} element The element\n * @param {Object} ctx The context\n */\nconst createInputCaret = (element, ctx) => {\n\n  /**\n   * Get position of old IE\n   *\n   * @returns {number}\n   */\n  const getIEPos = () => {\n    const range = ctx.document.selection.createRange();\n    let pos = 0;\n\n    if (range && range.parentElement() === element) {\n      /* eslint-disable */\n      const value = element.value.replace(/\\r\\n/g, \"\\n\");\n      /* eslint-enable */\n      const textInputRange = element.createTextRange();\n      textInputRange.moveToBookmark(range.getBookmark());\n      const endRange = element.createTextRange();\n      endRange.collapse(false);\n      if (textInputRange.compareEndPoints('StartToEnd', endRange) > -1) {\n        pos = value.length;\n      } else {\n        pos = -textInputRange.moveStart('character', -value.length);\n      }\n    }\n\n    return pos;\n  };\n\n  /**\n   * Get the current position\n   *\n   * @returns {number}\n   */\n  const getPos = () => {\n    if (ctx.document.selection) {\n      return getIEPos();\n    }\n\n    return element.selectionStart;\n  };\n\n  /**\n   * Set the position\n   * @todo: Where is this being used?\n   * @param {number} pos The position\n   */\n  const setPos = (pos) => {\n    // IE\n    if (ctx.document.selection) {\n      const range = element.createTextRange();\n      range.move('characters', pos);\n      range.select();\n    } else if (element.setSelectionRange) {\n      element.setSelectionRange(pos, pos);\n    }\n\n    return element;\n  };\n\n  /**\n   * Get the offset for old IE\n   *\n   * @param {number} pos The position\n   */\n  const getIEOffset = (pos) => {\n    const range = element.createTextRange();\n    const position = pos || getPos();\n    range.move('character', position);\n\n    return {\n      x: range.boundingLeft,\n      y: range.boundingTop,\n      h: range.boundingHeight\n    };\n  };\n\n  /**\n   * The offset\n   *\n   * @param {number} pos String\n   */\n  const getOffset = (pos) => {\n    let offset;\n    if (ctx.document.selection) {\n      offset = getIEOffset(pos);\n      offset.top += ctx.window.scrollTop + element.scrollTop;\n      offset.left += ctx.window.scrollLeft + element.scrollLeft;\n    } else {\n      const rect = element.getBoundingClientRect();\n      const position = getPosition(pos);\n      offset = {\n        top: rect.top + position.top + ctx.document.body.scrollTop,\n        left: rect.left + position.left + ctx.document.body.scrollLeft\n      };\n    }\n\n    return offset;\n  };\n\n  /**\n   * Get the current position\n   *\n   * @param {number} pos The position\n   */\n  const getPosition = (pos) => {\n    const format = (val) => {\n      let value = val.replace(/<|>|`|\"|&/g, '?')\n        .replace(/\\r\\n|\\r|\\n/g,'<br/>');\n      if (/firefox/i.test(navigator.userAgent)) {\n        value = value.replace(/\\s/g, '&nbsp;');\n      }\n      return value;\n    };\n\n    const position = pos === undefined ? getPos() : pos;\n    const startRange = element.value.slice(0, position);\n    const endRange = element.value.slice(position);\n    let html = `<span style=\"position: relative; display: inline;\">${format(startRange)}</span>`;\n    html += '<span id=\"caret-position-marker\" style=\"position: relative; display: inline;\">|</span>';\n    html += `<span style=\"position: relative; display: inline;\">${format(endRange)}</span>`;\n\n    const mirror = createMirror(element, html);\n    return mirror.rect();\n  };\n\n  return {\n    getPos,\n    setPos,\n    getIEPos,\n    getIEOffset,\n    getOffset,\n    getPosition,\n  };\n};\n\nexport default createInputCaret;\n","const createEditableCaret = (element, ctx) => {\n\n  const setPos = (pos) => {\n    const sel = ctx.window.getSelection();\n    if (sel) {\n      let offset = 0;\n      let found = false;\n      const find = (pos, parent) => {\n        for (const node in parent.childNodes) {\n          if (found) {\n            break;\n          }\n          if (node.nodeType === 3) {\n            if (offset + node.length >= pos) {\n              found = true;\n              const range = ctx.document.createRange();\n              range.setStart(node, pos - offset);\n              sel.removeAllRanges();\n              sel.addRange(range);\n              break;\n            } else {\n              offset += node.length;\n            }\n          } else {\n            find(pos, node);\n          }\n        }\n      };\n      find(pos, element);\n    }\n\n    return element;\n  };\n\n  const getOffset = () => {\n    const range = getRange();\n    let offset;\n    if (ctx.window.getSelection && range) {\n      // endContainer in Firefox would be the element at the start of\n      // the line\n      if (range.endOffset - 1 > 0 && range.endContainer !== element) {\n        const clonedRange = range.cloneRange();\n        clonedRange.setStart(range.endContainer, range.endOffset - 1);\n        clonedRange.setEnd(range.endContainer, range.endOffset);\n        const rect = clonedRange.getBoundingClientRect();\n        offset = {\n          height: rect.height,\n          left: rect.left + rect.width,\n          top: rect.top,\n        };\n        clonedRange.detach();\n      }\n\n      if (!offset || (offset && offset.height === 0)) {\n        const clonedRange = range.cloneRange();\n        const shadowCaret = ctx.document.createTextNode('|');\n        clonedRange.insertNode(shadowCaret);\n        clonedRange.selectNode(shadowCaret);\n        const rect = clonedRange.getBoundingClientRect();\n        offset = {\n          height: rect.height,\n          left: rect.left,\n          top: rect.top,\n        };\n        shadowCaret.parentNode.removeChild(shadowCaret);\n        clonedRange.detach();\n      }\n    } else if (ctx.document.selection) {\n      offset = getOldIEOffset();\n    }\n\n    if (offset) {\n      const doc = ctx.document.documentElement;\n      offset.top += ctx.window.pageYOffset - (doc.clientTop || 0);\n      offset.left += ctx.window.pageXOffset - (doc.clientLeft || 0);\n    }\n\n    return offset;\n  };\n\n  const getPosition = () => {\n    const offset = getOffset();\n    const rect = element.getBoundingClientRect();\n    const inputOffset = {\n      top: rect.top + ctx.document.body.scrollTop,\n      left: rect.left + ctx.document.body.scrollLeft\n    };\n    offset.left -= inputOffset.left;\n    offset.top -= inputOffset.top;\n\n    return offset;\n  };\n\n  const getOldIEPos = () => {\n    const textRange = ctx.document.selection.createRange();\n    const startTextRange = ctx.document.body.createTextRange();\n    startTextRange.moveToElementText(element);\n    startTextRange.setEndPoint('EndToEnd', textRange);\n\n    return startTextRange.text.length;\n  };\n\n  const getRange = () => {\n    if (!ctx.window.getSelection) {\n      return;\n    }\n    const sel = ctx.window.getSelection();\n\n    return sel.rangeCount > 0 ? sel.getRangeAt(0) : null;\n  };\n\n  const getPos = () => {\n    const range = getRange();\n    if (range) {\n      const clonedRange = range.cloneRange();\n      clonedRange.selectNodeContents(element);\n      clonedRange.setEnd(range.endContainer, range.endOffset);\n      const pos = clonedRange.toString().length;\n      clonedRange.detach();\n      return pos;\n    } else {\n      return getOldIEPos();\n    }\n  };\n\n  const getOldIEOffset = () => {\n    const range = ctx.document.selection.createRange().dupliate();\n    range.moveStart('character', -1);\n    const rect = range.getBoundingClientRect();\n\n    return {\n      height: rect.bottom - rect.top,\n      left: rect.left,\n      top: rect.top,\n    };\n  };\n\n  const getIEPosition = () => getPosition();\n\n  return {\n    getPos,\n    setPos,\n    getPosition,\n    getOldIEPos,\n    getIEPosition,\n    getOffset,\n    getOldIEOffset,\n    getRange,\n  };\n};\n\nexport default createEditableCaret;\n","export const isContentEditable = (element) => !!(\n  element.contentEditable &&\n  element.contentEditable === 'true'\n);\n\nexport const getContext = (settings = {}) => {\n  const { iframe } = settings;\n  if (iframe) {\n    return {\n      iframe,\n      window: iframe.contentWindow,\n      document: iframe.contentDocument || iframe.contentWindow.document,\n    };\n  }\n\n  return {\n    window,\n    document,\n  };\n};\n","import createInputCaret from './input';\nimport createEditableCaret from './editable';\nimport { isContentEditable, getContext } from './utils';\n\n\nconst createCaret = (element, ctx) => {\n  if (isContentEditable(element)) {\n    return createEditableCaret(element, ctx);\n  }\n\n  return createInputCaret(element, ctx);\n};\n\nexport const position = (element, value) => {\n  let val = value;\n  const ctx = getContext();\n  const caret = createCaret(element, ctx);\n  return caret.getPos(val);\n};\n\nexport const offset = (element, pos) => {\n  const ctx = getContext();\n  const caret = createCaret(element, ctx);\n  return caret.getOffset(pos);\n};\n\n\n// Just tests\nconst input = document.getElementById('input');\ninput.addEventListener('click', () => {\n  const pos = position(input);\n  console.log(pos);\n  console.log(offset(input, pos));\n});\n\nconst editable = document.getElementById('editable');\neditable.addEventListener('click', () => {\n  const pos = position(editable);\n  console.log(pos);\n  console.log(offset(editable, pos));\n});\n"],"names":["attributes","createMirror","element","html","mirror","document","createElement","mirrorCss","css","tagName","push","forEach","attr","getComputedStyle","initialize","styles","keys","key","style","innerHTML","parentNode","insertBefore","nextSibling","rect","marker","ownerDocument","getElementById","boundingRect","offsetLeft","offsetTop","offsetHeight","removeChild","createInputCaret","ctx","getIEPos","range","selection","createRange","pos","parentElement","value","replace","textInputRange","createTextRange","moveToBookmark","getBookmark","endRange","collapse","compareEndPoints","length","moveStart","getPos","selectionStart","setPos","move","select","setSelectionRange","getIEOffset","position","boundingLeft","boundingTop","boundingHeight","getOffset","offset","top","window","scrollTop","left","scrollLeft","getBoundingClientRect","getPosition","body","format","val","test","navigator","userAgent","undefined","startRange","slice","createEditableCaret","sel","getSelection","found","find","parent","node","childNodes","nodeType","setStart","removeAllRanges","addRange","getRange","endOffset","endContainer","clonedRange","cloneRange","setEnd","height","width","detach","shadowCaret","createTextNode","insertNode","selectNode","getOldIEOffset","doc","documentElement","pageYOffset","clientTop","pageXOffset","clientLeft","inputOffset","getOldIEPos","textRange","startTextRange","moveToElementText","setEndPoint","text","rangeCount","getRangeAt","selectNodeContents","toString","dupliate","bottom","getIEPosition","isContentEditable","contentEditable","getContext","settings","iframe","contentWindow","contentDocument","createCaret","caret","input","addEventListener","log","editable"],"mappings":"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"}